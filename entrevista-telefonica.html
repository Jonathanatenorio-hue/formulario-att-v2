<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entrevista Telef√≥nica | Expertcell - AT&T</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; }
        .header { background: linear-gradient(135deg, #00A8E1 0%, #0066CC 100%); color: white; padding: 30px; border-radius: 16px 16px 0 0; text-align: center; }
        .header h1 { font-size: 24px; margin-bottom: 5px; }
        .header p { opacity: 0.9; font-size: 14px; }
        .content { background: white; padding: 30px; border-radius: 0 0 16px 16px; }
        
        .nav-tabs { display: flex; gap: 10px; margin-bottom: 25px; background: #f1f5f9; padding: 8px; border-radius: 12px; flex-wrap: wrap; }
        .nav-tab { flex: 1; min-width: 120px; padding: 14px 15px; border: none; border-radius: 8px; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.3s; background: transparent; color: #64748b; display: flex; align-items: center; justify-content: center; gap: 6px; }
        .nav-tab:hover { background: #e2e8f0; }
        .nav-tab.active { background: linear-gradient(135deg, #00A8E1 0%, #0066CC 100%); color: white; box-shadow: 0 4px 15px rgba(0,102,204,0.3); }
        .nav-tab .badge { background: rgba(255,255,255,0.2); padding: 2px 8px; border-radius: 10px; font-size: 11px; }
        .nav-tab.active .badge { background: rgba(255,255,255,0.3); }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .calendario-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px; }
        .calendario-header h2 { font-size: 20px; color: #1e293b; }
        .calendario-filters { display: flex; gap: 10px; flex-wrap: wrap; }
        .calendario-filters select { padding: 10px 15px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; cursor: pointer; }
        .calendario-filters select:focus { outline: none; border-color: #0066CC; }
        
        .stats-cards { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 25px; }
        .stat-card { background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); padding: 20px; border-radius: 12px; text-align: center; border: 2px solid #e2e8f0; }
        .stat-card.today { border-color: #00A8E1; background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%); }
        .stat-card.pending { border-color: #ff9800; background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%); }
        .stat-card.no-contesto { border-color: #f44336; background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%); }
        .stat-card .number { font-size: 32px; font-weight: 700; color: #1e293b; }
        .stat-card .label { font-size: 12px; color: #64748b; margin-top: 5px; }
        
        .calendario-grid { display: flex; flex-direction: column; gap: 15px; }
        
        .dia-section { background: #f8fafc; border-radius: 12px; overflow: hidden; border: 2px solid #e2e8f0; }
        .dia-header { background: linear-gradient(135deg, #1e293b 0%, #334155 100%); color: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; }
        .dia-header.hoy { background: linear-gradient(135deg, #00A8E1 0%, #0066CC 100%); }
        .dia-header h3 { font-size: 16px; }
        .dia-header .count { background: rgba(255,255,255,0.2); padding: 4px 12px; border-radius: 20px; font-size: 13px; }
        
        .citas-lista { padding: 15px; display: flex; flex-direction: column; gap: 12px; }
        .cita-card { background: white; border-radius: 10px; padding: 15px; border-left: 4px solid #00A8E1; box-shadow: 0 2px 8px rgba(0,0,0,0.05); display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px; }
        .cita-card.sobresaliente { border-left-color: #4CAF50; }
        .cita-card.excelente { border-left-color: #2196F3; }
        .cita-card.muy-bueno { border-left-color: #ff9800; }
        .cita-card.no-contesto { border-left-color: #f44336; background: #fff5f5; }
        
        .cita-info { flex: 1; min-width: 200px; }
        .cita-info .nombre { font-weight: 600; font-size: 16px; color: #1e293b; margin-bottom: 4px; display: flex; align-items: center; gap: 8px; }
        .cita-info .intentos { background: #f44336; color: white; padding: 2px 8px; border-radius: 10px; font-size: 11px; }
        .cita-info .estado-tag { padding: 2px 8px; border-radius: 10px; font-size: 11px; font-weight: 600; }
        .cita-info .estado-tag.nuevo { background: #e3f2fd; color: #1565c0; }
        .cita-info .estado-tag.no-contesto { background: #ffebee; color: #c62828; }
        .cita-info .detalles { font-size: 13px; color: #64748b; display: flex; flex-wrap: wrap; gap: 10px; margin-top: 5px; }
        .cita-info .hora { background: #e0f2fe; color: #0277bd; padding: 3px 10px; border-radius: 15px; font-weight: 600; }
        .cita-info .clasificacion { font-size: 11px; padding: 2px 8px; border-radius: 10px; font-weight: 600; }
        .cita-info .clasificacion.sobresaliente { background: #c8e6c9; color: #2e7d32; }
        .cita-info .clasificacion.excelente { background: #bbdefb; color: #1565c0; }
        .cita-info .clasificacion.muy-bueno { background: #ffe0b2; color: #e65100; }
        
        .cita-acciones { display: flex; gap: 8px; flex-wrap: wrap; }
        .btn-accion { padding: 8px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 5px; transition: all 0.2s; }
        .btn-llamar { background: #e3f2fd; color: #1565c0; }
        .btn-llamar:hover { background: #1565c0; color: white; }
        .btn-whatsapp { background: #e8f5e9; color: #2e7d32; }
        .btn-whatsapp:hover { background: #25D366; color: white; }
        .btn-no-contesto { background: #ffebee; color: #c62828; }
        .btn-no-contesto:hover { background: #f44336; color: white; }
        .btn-evaluar { background: linear-gradient(135deg, #00A8E1 0%, #0066CC 100%); color: white; }
        .btn-evaluar:hover { transform: scale(1.05); }
        
        .empty-state { text-align: center; padding: 40px; color: #64748b; }
        .empty-state .icon { font-size: 48px; margin-bottom: 15px; }
        .empty-state h3 { color: #1e293b; margin-bottom: 8px; }
        
        .loading-spinner { text-align: center; padding: 40px; }
        .loading-spinner .spinner { width: 40px; height: 40px; border: 4px solid #e2e8f0; border-top-color: #0066CC; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 15px; }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* Estilos del Historial */
        .historial-card { background: white; border-radius: 10px; padding: 15px; border-left: 4px solid #9e9e9e; box-shadow: 0 2px 8px rgba(0,0,0,0.05); margin-bottom: 12px; }
        .historial-card.aprobado { border-left-color: #4CAF50; }
        .historial-card.rechazado { border-left-color: #f44336; }
        .historial-card.reservas { border-left-color: #ff9800; }
        .historial-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .historial-header .nombre { font-weight: 600; font-size: 16px; color: #1e293b; }
        .historial-header .resultado { padding: 4px 12px; border-radius: 15px; font-size: 12px; font-weight: 600; }
        .historial-header .resultado.aprobado { background: #c8e6c9; color: #2e7d32; }
        .historial-header .resultado.rechazado { background: #ffcdd2; color: #c62828; }
        .historial-header .resultado.reservas { background: #ffe0b2; color: #e65100; }
        .historial-detalles { display: flex; flex-wrap: wrap; gap: 15px; font-size: 13px; color: #64748b; }
        .historial-detalles span { display: flex; align-items: center; gap: 5px; }
        .btn-ver-detalle { background: #f1f5f9; color: #475569; border: none; padding: 6px 12px; border-radius: 6px; font-size: 12px; cursor: pointer; margin-top: 10px; }
        .btn-ver-detalle:hover { background: #e2e8f0; }
        
        .detalle-entrevista { display: none; background: #f8fafc; padding: 15px; border-radius: 8px; margin-top: 10px; }
        .detalle-entrevista.visible { display: block; }
        .detalle-entrevista h4 { font-size: 14px; color: #1e293b; margin-bottom: 10px; }
        .detalle-pregunta { margin-bottom: 12px; padding: 10px; background: white; border-radius: 6px; }
        .detalle-pregunta .pregunta-titulo { font-size: 12px; color: #0066CC; font-weight: 600; margin-bottom: 5px; }
        .detalle-pregunta .pregunta-texto { font-size: 12px; color: #666; font-style: italic; margin-bottom: 8px; background: #e3f2fd; padding: 8px; border-radius: 4px; }
        .detalle-pregunta .pregunta-respuesta { font-size: 13px; color: #333; }
        .detalle-pregunta .pregunta-puntaje { font-size: 12px; color: #666; margin-top: 5px; }
        
        /* Estilos Listado Panel */
        .panel-card { background: white; border-radius: 12px; margin-bottom: 15px; overflow: hidden; border: 2px solid #e2e8f0; }
        .panel-card-header { background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #e2e8f0; }
        .panel-card-header h3 { margin: 0; font-size: 16px; color: #1e293b; }
        .panel-card-header .hora { background: #0066CC; color: white; padding: 5px 12px; border-radius: 20px; font-size: 13px; font-weight: 600; }
        .panel-card-body { padding: 20px; }
        .panel-info-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 15px; }
        .panel-info-item { font-size: 13px; }
        .panel-info-item strong { color: #64748b; display: block; font-size: 11px; margin-bottom: 2px; }
        .panel-puntajes { display: flex; gap: 10px; margin: 15px 0; }
        .panel-puntaje { background: #f1f5f9; padding: 10px 15px; border-radius: 8px; text-align: center; flex: 1; }
        .panel-puntaje .score { font-size: 20px; font-weight: 700; color: #1e293b; }
        .panel-puntaje .label { font-size: 11px; color: #64748b; }
        .panel-puntaje.pasa { background: #dcfce7; }
        .panel-puntaje.pasa .score { color: #166534; }
        .panel-puntaje.reservas { background: #fef3c7; }
        .panel-puntaje.reservas .score { color: #92400e; }
        .panel-estado { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; }
        .panel-estado.confirmado { background: #dcfce7; color: #166534; }
        .panel-estado.asignado { background: #fef3c7; color: #92400e; }
        .panel-analisis { background: #fffbeb; border-left: 4px solid #f59e0b; padding: 15px; margin-top: 15px; border-radius: 0 8px 8px 0; }
        .panel-analisis h4 { margin: 0 0 8px; color: #92400e; font-size: 13px; }
        .panel-analisis p { margin: 0; font-size: 13px; color: #1e293b; line-height: 1.5; }
        .panel-respuestas { background: #f8fafc; padding: 15px; border-radius: 8px; margin-top: 15px; }
        .panel-respuestas h4 { margin: 0 0 12px; color: #1e293b; font-size: 14px; }
        .panel-respuesta-item { background: white; padding: 10px; border-radius: 6px; margin-bottom: 8px; }
        .panel-respuesta-item .q-titulo { font-size: 11px; color: #0066CC; font-weight: 600; margin-bottom: 4px; }
        .panel-respuesta-item .q-respuesta { font-size: 13px; color: #333; }
        .panel-toggle-respuestas { background: none; border: none; color: #0066CC; cursor: pointer; font-size: 13px; padding: 0; margin-top: 10px; }
        .panel-toggle-respuestas:hover { text-decoration: underline; }
        
        /* Estilos Listado Compacto */
        .panel-card-compact { background: white; border-radius: 10px; margin-bottom: 10px; padding: 12px 15px; border: 1px solid #e2e8f0; }
        .panel-compact-header { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px; }
        .panel-compact-left { display: flex; align-items: center; gap: 12px; flex: 1; }
        .panel-compact-num { background: #0066CC; color: white; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 13px; }
        .panel-compact-info { flex: 1; }
        .panel-compact-nombre { font-weight: 600; font-size: 15px; color: #1e293b; }
        .panel-compact-detalles { font-size: 12px; color: #64748b; margin-top: 3px; }
        .panel-compact-right { display: flex; align-items: center; gap: 15px; }
        .panel-compact-hora { background: #0066CC; color: white; padding: 4px 10px; border-radius: 15px; font-size: 13px; font-weight: 600; }
        .panel-compact-puntajes { display: flex; gap: 8px; }
        .panel-mini-puntaje { background: #f1f5f9; padding: 3px 8px; border-radius: 10px; font-size: 11px; font-weight: 600; color: #475569; }
        .panel-mini-puntaje.pasa { background: #dcfce7; color: #166534; }
        .panel-mini-puntaje.reservas { background: #fef3c7; color: #92400e; }

        .scoring-guide { background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); padding: 20px; border-radius: 12px; margin-bottom: 25px; border: 2px solid #4CAF50; }
        .scoring-guide h3 { color: #2e7d32; margin-bottom: 15px; font-size: 16px; text-align: center; }
        .scoring-guide .ranges { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .scoring-guide .range { padding: 12px; border-radius: 8px; text-align: center; }
        .scoring-guide .range-pass { background: #4CAF50; color: white; }
        .scoring-guide .range-maybe { background: #FF9800; color: white; }
        .scoring-guide .range-fail { background: #f44336; color: white; }
        .scoring-guide .range strong { display: block; font-size: 18px; }
        .scoring-guide .range span { font-size: 12px; }
        
        .section { margin-bottom: 30px; padding-bottom: 25px; border-bottom: 2px solid #eee; }
        .section:last-child { border-bottom: none; margin-bottom: 0; }
        .section-title { font-size: 18px; color: #333; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; color: #333; font-weight: 600; }
        .form-group select, .form-group input, .form-group textarea { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 15px; }
        .form-group select:focus, .form-group input:focus, .form-group textarea:focus { outline: none; border-color: #0066CC; }
        
        .candidate-info { background: linear-gradient(135deg, #e8f4fd 0%, #d1e8fa 100%); padding: 20px; border-radius: 12px; margin-bottom: 20px; display: none; }
        .candidate-info h3 { color: #0066CC; margin-bottom: 15px; font-size: 16px; }
        .candidate-info .info-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
        .candidate-info .info-item { font-size: 14px; }
        .candidate-info .info-item strong { color: #333; }
        
        .score-badge { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 14px; font-weight: 600; }
        .score-high { background: #c8e6c9; color: #2e7d32; }
        .score-med { background: #fff9c4; color: #f57f17; }
        .score-low { background: #ffcdd2; color: #c62828; }
        
        .evaluation-card { background: #f8f9fa; border-radius: 12px; padding: 25px; margin-bottom: 25px; border-left: 4px solid #0066CC; }
        .evaluation-card h4 { color: #333; margin-bottom: 8px; font-size: 18px; }
        .evaluation-card .question { color: #0066CC; font-style: italic; margin-bottom: 15px; font-size: 15px; background: #e3f2fd; padding: 12px; border-radius: 8px; }
        
        .flags-container { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
        .flag-box { padding: 15px; border-radius: 8px; font-size: 13px; }
        .red-flags { background: #ffebee; border: 1px solid #ffcdd2; }
        .red-flags h5 { color: #c62828; margin-bottom: 10px; font-size: 14px; }
        .red-flags li { color: #b71c1c; margin-left: 15px; margin-bottom: 5px; }
        .green-flags { background: #e8f5e9; border: 1px solid #c8e6c9; }
        .green-flags h5 { color: #2e7d32; margin-bottom: 10px; font-size: 14px; }
        .green-flags li { color: #1b5e20; margin-left: 15px; margin-bottom: 5px; }
        
        .response-section { margin-bottom: 20px; }
        .response-section label { display: block; margin-bottom: 8px; color: #333; font-weight: 600; font-size: 15px; }
        .response-section textarea { width: 100%; min-height: 100px; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px; resize: vertical; }
        .response-section textarea:focus { outline: none; border-color: #0066CC; }
        
        .score-selector { margin-top: 20px; }
        .score-selector label { display: block; margin-bottom: 10px; color: #333; font-weight: 600; }
        .score-options { display: flex; gap: 10px; flex-wrap: wrap; }
        .score-option { padding: 15px 20px; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; text-align: center; transition: all 0.3s; flex: 1; min-width: 70px; }
        .score-option:hover { border-color: #0066CC; background: #f0f8ff; }
        .score-option.selected { border-color: #0066CC; background: #0066CC; color: white; }
        .score-option .number { font-size: 24px; font-weight: bold; display: block; }
        
        .result-panel { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; border-radius: 12px; color: white; text-align: center; margin-top: 25px; display: none; }
        .result-panel h3 { font-size: 22px; margin-bottom: 15px; }
        .result-panel .total-score { font-size: 56px; font-weight: bold; margin: 15px 0; }
        .result-panel .verdict { font-size: 22px; padding: 12px 30px; border-radius: 30px; display: inline-block; margin-top: 15px; }
        .verdict-pass { background: #4CAF50; }
        .verdict-maybe { background: #FF9800; }
        .verdict-fail { background: #f44336; }
        
        .agenda-section { display: none; margin-top: 30px; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); padding: 25px; border-radius: 12px; border: 2px solid #4CAF50; }
        .agenda-section h3 { color: #2e7d32; margin-bottom: 20px; text-align: center; }
        .agenda-section.rejected { background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%); border-color: #f44336; }
        .agenda-section.rejected h3 { color: #c62828; }
        
        .viernes-selector { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px; margin-bottom: 20px; }
        .viernes-option { padding: 15px; border: 2px solid #4CAF50; border-radius: 10px; cursor: pointer; text-align: center; transition: all 0.3s; background: white; }
        .viernes-option:hover { background: #e8f5e9; }
        .viernes-option.selected { background: #4CAF50; color: white; }
        .viernes-option .fecha { font-weight: 600; font-size: 14px; }
        
        .horarios-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 10px; margin-bottom: 20px; }
        .horario-slot { padding: 12px; border: 2px solid #4CAF50; border-radius: 8px; cursor: pointer; text-align: center; transition: all 0.3s; background: white; font-size: 14px; }
        .horario-slot:hover:not(.ocupado) { background: #e8f5e9; }
        .horario-slot.selected { background: #4CAF50; color: white; }
        .horario-slot.ocupado { background: #ffcdd2; border-color: #f44336; color: #c62828; cursor: not-allowed; text-decoration: line-through; }
        .horario-slot.comida { background: #fff3e0; border-color: #ff9800; color: #e65100; cursor: not-allowed; }
        
        .email-field { margin: 20px 0; }
        .email-field input { padding: 15px; font-size: 16px; }
        
        .btn { padding: 14px 30px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; width: 100%; transition: all 0.3s; }
        .btn-primary { background: linear-gradient(135deg, #00A8E1 0%, #0066CC 100%); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(0,102,204,0.3); }
        .btn-success { background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%); color: white; margin-top: 15px; }
        .btn-whatsapp { background: linear-gradient(135deg, #25D366 0%, #128C7E 100%); color: white; margin-top: 10px; }
        .btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        
        .reclutadora-select { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .reclutadora-option { padding: 15px; border: 2px solid #e0e0e0; border-radius: 10px; cursor: pointer; text-align: center; transition: all 0.3s; }
        .reclutadora-option:hover { border-color: #0066CC; background: #f0f8ff; }
        .reclutadora-option.selected { border-color: #0066CC; background: linear-gradient(135deg, #e6f2ff 0%, #cce5ff 100%); }
        .reclutadora-option .name { font-weight: 600; color: #333; display: block; }
        .reclutadora-option .location { font-size: 12px; color: #666; }
        
        .hidden { display: none !important; }
        
        .loading { display: inline-block; width: 20px; height: 20px; border: 3px solid rgba(255,255,255,.3); border-radius: 50%; border-top-color: #fff; animation: spin 1s ease-in-out infinite; }
        
        .confirmacion-panel { display: none; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); padding: 30px; border-radius: 12px; margin-top: 20px; text-align: center; border: 2px solid #4CAF50; }
        .confirmacion-panel h3 { color: #2e7d32; margin-bottom: 15px; }
        .confirmacion-panel .detalle { background: white; padding: 20px; border-radius: 10px; margin: 20px 0; text-align: left; }
        .confirmacion-panel .detalle p { margin: 10px 0; font-size: 14px; }
        
        @media (max-width: 600px) {
            .nav-tabs { flex-direction: column; }
            .stats-cards { grid-template-columns: 1fr; }
            .flags-container { grid-template-columns: 1fr; }
            .reclutadora-select { grid-template-columns: 1fr; }
            .cita-card { flex-direction: column; align-items: flex-start; }
            .cita-acciones { width: 100%; justify-content: flex-start; }
        }
        
        /* Login Modal */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .login-modal {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .login-modal h2 {
            font-size: 24px;
            margin-bottom: 8px;
            color: #1e293b;
        }
        .login-modal p {
            color: #64748b;
            margin-bottom: 24px;
            font-size: 14px;
        }
        .login-modal .form-group {
            text-align: left;
            margin-bottom: 16px;
        }
        .login-modal .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #334155;
       }
       .login-modal .form-group select,
       .login-modal .form-group input {
           width: 100%;
           padding: 12px;
           border: 2px solid #e2e8f0;
           border-radius: 10px;
           font-size: 15px;
       }
       .login-avatar {
           width: 80px;
           height: 80px;
           background: linear-gradient(135deg, #00A8E1 0%, #0057B8 100%);
           border-radius: 50%;
           margin: 0 auto 20px;
           display: flex;
           align-items: center;
           justify-content: center;
           font-size: 32px;
           color: white;
      }
      .login-error {
          color: #ef4444;
          font-size: 13px;
          margin-top: 10px;
          display: none;
      }
      .user-badge {
          position: fixed;
          top: 20px;
          right: 20px;
          background: white;
          padding: 10px 16px;
          border-radius: 30px;
          box-shadow: 0 4px 15px rgba(0,0,0,0.1);
          display: flex;
          align-items: center;
          gap: 10px;
          z-index: 100;
      }
      .user-badge-avatar {
          width: 32px;
          height: 32px;
          background: linear-gradient(135deg, #00A8E1 0%, #0057B8 100%);
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          font-size: 12px;
          font-weight: 600;
      }
      .user-badge-name {
          font-size: 14px;
          font-weight: 600;
          color: #334155;
      }
      .user-badge-logout {
          background: none;
          border: none;
          color: #94a3b8;
          cursor: pointer;
          font-size: 16px;
          padding: 4px;
      }
      .user-badge-logout:hover {
          color: #ef4444;
      }
    </style>
</head>
<body>
    <!-- Login Modal -->
    <div class="login-overlay" id="login-overlay">
        <div class="login-modal">
            <div class="login-avatar">üîê</div>
            <h2>Entrevista Telef√≥nica</h2>
            <p>Ingresa tus credenciales para acceder</p>
            <div class="form-group">
                <label>Usuario</label>
                <select id="login-usuario">
                    <option value="">Selecciona...</option>
                </select>
            </div>
            <div class="form-group">
                <label>Contrase√±a</label>
                <input type="password" id="login-password" placeholder="Ingresa tu contrase√±a">
            </div>
            <div class="login-error" id="login-error">Contrase√±a incorrecta</div>
            <button class="btn-primary" style="width: 100%; padding: 14px; margin-top: 10px;" onclick="intentarLogin()">Ingresar ‚Üí</button>
        </div>
    </div>

    <!-- User Badge -->
    <div class="user-badge" id="user-badge" style="display: none;">
        <div class="user-badge-avatar" id="badge-avatar">XX</div>
        <span class="user-badge-name" id="badge-name">Usuario</span>
        <button class="user-badge-logout" onclick="cerrarSesion()" title="Cerrar sesi√≥n">‚úï</button>
    </div>
    <div class="container">
        <div class="header">
            <h1>üìû Entrevista Telef√≥nica</h1>
            <p>Evaluaci√≥n de Candidatos - Agente AT&T</p>
        </div>
        
        <div class="content">
            <!-- Tabs de navegaci√≥n -->
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="cambiarTab('calendario')">
                    üìÖ Mis Citas <span class="badge" id="badge-citas">0</span>
                </button>
                <button class="nav-tab" onclick="cambiarTab('evaluacion')">
                    üìù Nueva Evaluaci√≥n
                </button>
                <button class="nav-tab" onclick="cambiarTab('historial')">
                    üìã Historial
                </button>
                <button class="nav-tab" onclick="cambiarTab('listado-panel')">
                    üìä Listado Panel
                </button>
            </div>
            
            <!-- Tab: Calendario de Citas -->
            <div class="tab-content active" id="tab-calendario">
                <div class="calendario-header">
                    <h2>üìÖ Agenda de Entrevistas</h2>
                    <div class="calendario-filters">
                    <select id="filtro-sucursal" onchange="cargarCitasCalendario()">
                        <option value="">Todas las sucursales</option>
                        <option value="Torre JV Ju√°rez">Torre JV Ju√°rez</option>
                        <option value="Edificio Inbursa Antequera">Edificio Inbursa Antequera</option>
                    </select>
                    <select id="filtro-reclutadora" onchange="cargarCitasCalendario()">
                        <option value="">Todas las reclutadoras</option>
                        <option value="Karla Flores">Karla Flores</option>
                        <option value="Yessica Huerta">Yessica Huerta</option>
                        <option value="Jezabel Monterrosas">Jezabel Monterrosas</option>
                    </select>
                    <select id="filtro-periodo" onchange="cargarCitasCalendario()">
                        <option value="hoy">Hoy</option>
                        <option value="semana" selected>Esta semana</option>
                        <option value="mes">Este mes</option>
                    </select>
                </div>
               
                
                <div class="stats-cards" id="stats-cards" style="display: none;">
                    <div class="stat-card today">
                        <div class="number" id="stat-hoy">0</div>
                        <div class="label">üìÖ Citas Hoy</div>
                    </div>
                    <div class="stat-card pending">
                        <div class="number" id="stat-nuevas">0</div>
                        <div class="label">üÜï Nuevas</div>
                    </div>
                    <div class="stat-card no-contesto">
                        <div class="number" id="stat-nocontesto">0</div>
                        <div class="label">üìµ No Contest√≥</div>
                    </div>
                </div>
                
                <div class="calendario-grid" id="calendario-grid">
                    <div class="empty-state">
                        <div class="icon">üëÜ</div>
                        <h3>Selecciona una reclutadora</h3>
                        <p>Para ver las citas pendientes</p>
                    </div>
                </div>
            </div>
            
            <!-- Tab: Historial -->
            <div class="tab-content" id="tab-historial">
                <div class="calendario-header">
                    <h2>üìã Entrevistas Realizadas</h2>
                    <div class="calendario-filters">
                        <select id="filtro-reclutadora-historial" onchange="cargarHistorial()">
                            <option value="">Selecciona reclutadora...</option>
                            <option value="Karla Flores">Karla Flores</option>
                            <option value="Yessica Huerta">Yessica Huerta</option>
                            <option value="Jezabel Monterrosas">Jezabel Monterrosas</option>
                            <option value="TODAS">üìä Todas las reclutadoras</option>
                        </select>
                        <select id="filtro-resultado-historial" onchange="filtrarHistorial()">
                            <option value="todos">Todos los resultados</option>
                            <option value="PASA">‚úÖ Aprobados</option>
                            <option value="NO PASA">‚ùå Rechazados</option>
                            <option value="RESERVAS">‚ö†Ô∏è Con Reservas</option>
                        </select>
                    </div>
                </div>
                
                <!-- Barra de b√∫squeda y filtros de fecha -->
                <div class="historial-busqueda" style="margin-bottom: 20px;">
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
                        <div style="flex: 1; min-width: 200px;">
                            <input type="text" id="busqueda-historial" placeholder="üîç Buscar por nombre o tel√©fono..." onkeyup="filtrarHistorial()" style="width: 100%; padding: 12px 15px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px;">
                        </div>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <label style="font-size: 13px; color: #64748b;">Desde:</label>
                            <input type="date" id="fecha-desde-historial" onchange="filtrarHistorial()" style="padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 13px;">
                            <label style="font-size: 13px; color: #64748b;">Hasta:</label>
                            <input type="date" id="fecha-hasta-historial" onchange="filtrarHistorial()" style="padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 13px;">
                            <button onclick="limpiarFiltrosHistorial()" style="padding: 10px 15px; border: none; background: #f1f5f9; border-radius: 8px; cursor: pointer; font-size: 13px;">üóëÔ∏è Limpiar</button>
                        </div>
                    </div>
                </div>
                
                <div id="historial-grid">
                    <div class="empty-state">
                        <div class="icon">üëÜ</div>
                        <h3>Selecciona una reclutadora</h3>
                        <p>Para ver el historial de entrevistas</p>
                    </div>
                </div>
            </div>
            
            <!-- Tab: Evaluaci√≥n -->
            <div class="tab-content" id="tab-evaluacion">
                <div class="scoring-guide">
                    <h3>üìä GU√çA DE APROBACI√ìN</h3>
                    <div class="ranges">
                        <div class="range range-pass"><strong>25-30 pts</strong><span>‚úÖ PASA A PANEL</span></div>
                        <div class="range range-maybe"><strong>20-24 pts</strong><span>‚ö†Ô∏è CON RESERVAS</span></div>
                        <div class="range range-fail"><strong>0-19 pts</strong><span>‚ùå NO PASA</span></div>
                    </div>
                </div>

                <div class="section" id="section-reclutadora">
                    <div class="section-title">üë§ ¬øQui√©n realiza la entrevista?</div>
                    <div class="reclutadora-select">
                        <div class="reclutadora-option" onclick="selectReclutadora('Karla Flores', 'Torre JV Ju√°rez')">
                            <span class="name">Karla Flores</span>
                            <span class="location">Torre JV Ju√°rez</span>
                        </div>
                        <div class="reclutadora-option" onclick="selectReclutadora('Yessica Huerta', 'Edificio Inbursa')">
                            <span class="name">Yessica Huerta</span>
                            <span class="location">Edificio Inbursa</span>
                        </div>
                        <div class="reclutadora-option" onclick="selectReclutadora('Jezabel Monterrosas', 'Edificio Inbursa')">
                            <span class="name">Jezabel Monterrosas</span>
                            <span class="location">Edificio Inbursa</span>
                        </div>
                    </div>
                </div>

                <div class="section hidden" id="section-candidato">
                    <div class="section-title">üéØ Selecciona el candidato a entrevistar</div>
                    <div class="form-group">
                        <label>Candidatos pendientes de entrevista:</label>
                        <select id="candidato-select" onchange="loadCandidate()">
                            <option value="">-- Selecciona un candidato --</option>
                        </select>
                    </div>
                    
                    <div class="candidate-info" id="candidate-info">
                        <h3>üìã Informaci√≥n del Candidato</h3>
                        <div class="info-grid">
                            <div class="info-item"><strong>Nombre:</strong> <span id="info-nombre"></span></div>
                            <div class="info-item"><strong>Tel√©fono:</strong> <span id="info-telefono"></span></div>
                            <div class="info-item"><strong>Edad:</strong> <span id="info-edad"></span></div>
                            <div class="info-item"><strong>Ubicaci√≥n:</strong> <span id="info-ubicacion"></span></div>
                            <div class="info-item"><strong>Sucursal:</strong> <span id="info-sucursal"></span></div>
                            <div class="info-item"><strong>Pre-filtro:</strong> <span id="info-puntaje"></span></div>
                            <div class="info-item"><strong>Tiempo traslado:</strong> <span id="info-traslado"></span></div>
                            <div class="info-item"><strong>Ingreso esperado:</strong> <span id="info-ingreso"></span></div>
                        </div>

                        <!-- Bot√≥n Ver CV -->
                        <div id="cv-container" style="margin-top: 15px; display: none;">
                            <a id="btn-ver-cv" href="#" target="_blank" style="display: inline-block; background: linear-gradient(135deg, #9333EA 0%, #7C3AED 100%); color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: 500;">üìÑ Ver CV</a>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); padding: 20px; border-radius: 12px; margin-top: 15px; border: 2px solid #4CAF50;">
                        <h4 style="color: #2e7d32; margin-bottom: 15px; font-size: 16px;">üìû GU√çA DE INICIO DE LLAMADA</h4>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <p style="margin: 0 0 10px 0; color: #333; font-size: 14px;"><em>"Hola [Nombre], ¬øc√≥mo est√°s? Te habla [Tu nombre] de Expertcell, ¬øtienes 8‚Äì10 minutos para platicar?"</em></p>
                            <p style="margin: 0; color: #333; font-size: 14px;"><em>"Vi que ya llenaste el formulario, ya tengo claro tu perfil. Esta llamada es solo para validar algunos puntos."</em></p>
                        </div>
                    </div>
                </div>

                <div class="section hidden" id="section-evaluacion">
                    <div class="section-title">üìù Evaluaci√≥n de la Entrevista</div>
                    
                    <!-- Pregunta 1 -->
                    <div class="evaluation-card">
                        <h4>1Ô∏è‚É£ Coherencia</h4>
                        <div class="question">üì¢ "En el formulario comentaste que te motiva ganar por resultados, cu√©ntame una experiencia donde eso haya pasado."</div>
                        <div class="flags-container">
                            <div class="flag-box red-flags"><h5>üö© Red Flags</h5><ul><li>Respuestas vagas</li><li>Se contradice</li></ul></div>
                            <div class="flag-box green-flags"><h5>üíé Green Flags</h5><ul><li>Ejemplo concreto</li><li>Logros medibles</li></ul></div>
                        </div>
                        <div class="response-section">
                            <label>‚úçÔ∏è Respuesta:</label>
                            <textarea id="response-q1" placeholder="Escribe la respuesta..."></textarea>
                        </div>
                        <div class="score-selector">
                            <label>üìä Puntaje:</label>
                            <div class="score-options" id="score-options-q1">
                                <div class="score-option" onclick="selectScore('q1', 1)"><span class="number">1</span></div>
                                <div class="score-option" onclick="selectScore('q1', 2)"><span class="number">2</span></div>
                                <div class="score-option" onclick="selectScore('q1', 3)"><span class="number">3</span></div>
                                <div class="score-option" onclick="selectScore('q1', 4)"><span class="number">4</span></div>
                                <div class="score-option" onclick="selectScore('q1', 5)"><span class="number">5</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- Pregunta 2 -->
                    <div class="evaluation-card">
                        <h4>2Ô∏è‚É£ Comunicaci√≥n Real</h4>
                        <div class="question">üì¢ "Expl√≠came en 30 segundos qu√© hac√≠as en tu √∫ltimo trabajo."</div>
                        <div class="flags-container">
                            <div class="flag-box red-flags"><h5>üö© Red Flags</h5><ul><li>Desordenado</li><li>Muchas muletillas</li></ul></div>
                            <div class="flag-box green-flags"><h5>üíé Green Flags</h5><ul><li>Claro y directo</li><li>Seguridad</li></ul></div>
                        </div>
                        <div class="response-section">
                            <label>‚úçÔ∏è Respuesta:</label>
                            <textarea id="response-q2" placeholder="Escribe la respuesta..."></textarea>
                        </div>
                        <div class="score-selector">
                            <label>üìä Puntaje:</label>
                            <div class="score-options" id="score-options-q2">
                                <div class="score-option" onclick="selectScore('q2', 1)"><span class="number">1</span></div>
                                <div class="score-option" onclick="selectScore('q2', 2)"><span class="number">2</span></div>
                                <div class="score-option" onclick="selectScore('q2', 3)"><span class="number">3</span></div>
                                <div class="score-option" onclick="selectScore('q2', 4)"><span class="number">4</span></div>
                                <div class="score-option" onclick="selectScore('q2', 5)"><span class="number">5</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- Pregunta 3 -->
                    <div class="evaluation-card">
                        <h4>3Ô∏è‚É£ Manejo del Rechazo</h4>
                        <div class="question">üì¢ "Cu√©ntame una llamada dif√≠cil y c√≥mo la manejaste."</div>
                        <div class="flags-container">
                            <div class="flag-box red-flags"><h5>üö© Red Flags</h5><ul><li>Culpa al cliente</li><li>Evita el tema</li></ul></div>
                            <div class="flag-box green-flags"><h5>üíé Green Flags</h5><ul><li>Asume responsabilidad</li><li>Resiliencia</li></ul></div>
                        </div>
                        <div class="response-section">
                            <label>‚úçÔ∏è Respuesta:</label>
                            <textarea id="response-q3" placeholder="Escribe la respuesta..."></textarea>
                        </div>
                        <div class="score-selector">
                            <label>üìä Puntaje:</label>
                            <div class="score-options" id="score-options-q3">
                                <div class="score-option" onclick="selectScore('q3', 1)"><span class="number">1</span></div>
                                <div class="score-option" onclick="selectScore('q3', 2)"><span class="number">2</span></div>
                                <div class="score-option" onclick="selectScore('q3', 3)"><span class="number">3</span></div>
                                <div class="score-option" onclick="selectScore('q3', 4)"><span class="number">4</span></div>
                                <div class="score-option" onclick="selectScore('q3', 5)"><span class="number">5</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- Pregunta 4 -->
                    <div class="evaluation-card">
                        <h4>4Ô∏è‚É£ Energ√≠a y Actitud</h4>
                        <div class="question">üì¢ "¬øQu√© te gusta y qu√© no te gusta de trabajar en ventas?"</div>
                        <div class="flags-container">
                            <div class="flag-box red-flags"><h5>üö© Red Flags</h5><ul><li>Actitud negativa</li><li>Inmadurez</li></ul></div>
                            <div class="flag-box green-flags"><h5>üíé Green Flags</h5><ul><li>Equilibrado</li><li>Autoconocimiento</li></ul></div>
                        </div>
                        <div class="response-section">
                            <label>‚úçÔ∏è Respuesta:</label>
                            <textarea id="response-q4" placeholder="Escribe la respuesta..."></textarea>
                        </div>
                        <div class="score-selector">
                            <label>üìä Puntaje:</label>
                            <div class="score-options" id="score-options-q4">
                                <div class="score-option" onclick="selectScore('q4', 1)"><span class="number">1</span></div>
                                <div class="score-option" onclick="selectScore('q4', 2)"><span class="number">2</span></div>
                                <div class="score-option" onclick="selectScore('q4', 3)"><span class="number">3</span></div>
                                <div class="score-option" onclick="selectScore('q4', 4)"><span class="number">4</span></div>
                                <div class="score-option" onclick="selectScore('q4', 5)"><span class="number">5</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- Pregunta 5 -->
                    <div class="evaluation-card">
                        <h4>5Ô∏è‚É£ Realismo del Puesto</h4>
                        <div class="question">üì¢ "Trabajamos con metas diarias y presi√≥n. ¬øQu√© te costar√≠a m√°s?"</div>
                        <div class="flags-container">
                            <div class="flag-box red-flags"><h5>üö© Red Flags</h5><ul><li>Idealiza todo</li><li>Sin estrategia</li></ul></div>
                            <div class="flag-box green-flags"><h5>üíé Green Flags</h5><ul><li>Consciente</li><li>Tiene plan</li></ul></div>
                        </div>
                        <div class="response-section">
                            <label>‚úçÔ∏è Respuesta:</label>
                            <textarea id="response-q5" placeholder="Escribe la respuesta..."></textarea>
                        </div>
                        <div class="score-selector">
                            <label>üìä Puntaje:</label>
                            <div class="score-options" id="score-options-q5">
                                <div class="score-option" onclick="selectScore('q5', 1)"><span class="number">1</span></div>
                                <div class="score-option" onclick="selectScore('q5', 2)"><span class="number">2</span></div>
                                <div class="score-option" onclick="selectScore('q5', 3)"><span class="number">3</span></div>
                                <div class="score-option" onclick="selectScore('q5', 4)"><span class="number">4</span></div>
                                <div class="score-option" onclick="selectScore('q5', 5)"><span class="number">5</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- Pregunta 6 -->
                    <div class="evaluation-card">
                        <h4>6Ô∏è‚É£ Cierre - Autoventa</h4>
                        <div class="question">üì¢ "¬øPor qu√© deber√≠amos avanzar contigo y no con otro?"</div>
                        <div class="flags-container">
                            <div class="flag-box red-flags"><h5>üö© Red Flags</h5><ul><li>No sabe qu√© decir</li><li>Gen√©rico</li></ul></div>
                            <div class="flag-box green-flags"><h5>üíé Green Flags</h5><ul><li>Se vende bien</li><li>Diferenciadores</li></ul></div>
                        </div>
                        <div class="response-section">
                            <label>‚úçÔ∏è Respuesta:</label>
                            <textarea id="response-q6" placeholder="Escribe la respuesta..."></textarea>
                        </div>
                        <div class="score-selector">
                            <label>üìä Puntaje:</label>
                            <div class="score-options" id="score-options-q6">
                                <div class="score-option" onclick="selectScore('q6', 1)"><span class="number">1</span></div>
                                <div class="score-option" onclick="selectScore('q6', 2)"><span class="number">2</span></div>
                                <div class="score-option" onclick="selectScore('q6', 3)"><span class="number">3</span></div>
                                <div class="score-option" onclick="selectScore('q6', 4)"><span class="number">4</span></div>
                                <div class="score-option" onclick="selectScore('q6', 5)"><span class="number">5</span></div>
                            </div>
                        </div>
                    </div>

                    <div class="evaluation-card" style="border-left-color: #9c27b0;">
                        <h4>üìù Observaciones Generales</h4>
                        <textarea id="observaciones-generales" placeholder="Comentarios adicionales..." style="width:100%; min-height:100px; padding:12px; border:2px solid #e0e0e0; border-radius:8px;"></textarea>
                    </div>

                    <div class="result-panel" id="result-panel">
                        <h3>Resultado de la Entrevista</h3>
                        <div class="total-score" id="total-score">0/30</div>
                        <p id="verdict-text"></p>
                        <div class="verdict" id="verdict-badge"></div>
                    </div>

                    <button class="btn btn-primary" id="btn-calcular" onclick="calcularResultado()">üìä Calcular Resultado</button>
                </div>

                <div class="agenda-section" id="agenda-section">
                    <h3>üìÖ Agendar Entrevista Panel (Viernes)</h3>
                    <div class="email-field">
                        <label style="font-weight:600; margin-bottom:8px; display:block;">üìß Correo del candidato:</label>
                        <input type="email" id="email-candidato" placeholder="ejemplo@correo.com">
                    </div>
                    <div style="margin-bottom:20px;">
                        <label style="font-weight:600; margin-bottom:10px; display:block;">Selecciona el viernes:</label>
                        <div class="viernes-selector" id="viernes-selector"></div>
                    </div>
                    <div id="horarios-container" style="display:none;">
                        <label style="font-weight:600; margin-bottom:10px; display:block;">Selecciona el horario:</label>
                        <div class="horarios-grid" id="horarios-grid"></div>
                    </div>
                    <button class="btn btn-success" id="btn-agendar" onclick="confirmarAgenda()" style="display:none;">‚úÖ Confirmar Cita</button>
                </div>

                <div class="agenda-section rejected" id="rejected-section" style="display:none;">
                    <h3>üòî Candidato No Aprobado</h3>
                    <p style="margin:15px 0; color:#c62828;">No alcanz√≥ el puntaje m√≠nimo requerido.</p>
                    <button class="btn btn-whatsapp" onclick="enviarWhatsAppRechazo()">üí¨ Enviar agradecimiento</button>
                    <button class="btn" onclick="nuevaEvaluacion()" style="margin-top:10px; background:#666; color:white;">üîÑ Nueva Evaluaci√≥n</button>
                </div>

                <div class="confirmacion-panel" id="confirmacion-panel">
                    <h3>‚úÖ ¬°Cita Agendada!</h3>
                    <div class="detalle">
                        <p><strong>üë§ Candidato:</strong> <span id="conf-nombre"></span></p>
                        <p><strong>üìÖ Fecha:</strong> <span id="conf-fecha"></span></p>
                        <p><strong>üïê Hora:</strong> <span id="conf-hora"></span></p>
                        <p><strong>üìç Sucursal:</strong> <span id="conf-sucursal"></span></p>
                        <p><strong>üìß Email:</strong> <span id="conf-email"></span></p>
                    </div>
                    <button class="btn btn-whatsapp" onclick="enviarWhatsAppAprobado()">üí¨ WhatsApp</button>
                    <button class="btn btn-primary" onclick="enviarEmailAprobado()" style="margin-top:10px;">üìß Email</button>
                    <button class="btn" onclick="nuevaEvaluacion()" style="margin-top:15px; background:#666; color:white;">üîÑ Nueva Evaluaci√≥n</button>
                </div>
            </div>
            <!-- Tab: Listado Panel -->
            <div class="tab-content" id="tab-listado-panel">
                <div class="calendario-header">
                    <h2>üìä Listado Entrevistas Panel</h2>
                    <div class="calendario-filters">
                        <select id="filtro-viernes-panel" onchange="cargarListadoPanel()">
                            <option value="">Selecciona un viernes...</option>
                        </select>
                        <select id="filtro-sucursal-panel" onchange="cargarListadoPanel()">
                            <option value="TODAS">Todas las sucursales</option>
                            <option value="Torre JV Ju√°rez">Torre JV Ju√°rez</option>
                            <option value="Edificio Inbursa Antequera">Edificio Inbursa Antequera</option>
                        </select>
                    </div>
                </div>
                
                <!-- Stats del listado -->
                <div class="stats-cards" id="stats-panel" style="display: none;">
                    <div class="stat-card today">
                        <div class="number" id="stat-total-panel">0</div>
                        <div class="label">üìã Total Candidatos</div>
                    </div>
                    <div class="stat-card" style="border-color: #4CAF50; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);">
                        <div class="number" id="stat-confirmados-panel">0</div>
                        <div class="label">‚úÖ Confirmados</div>
                    </div>
                    <div class="stat-card pending">
                        <div class="number" id="stat-pendientes-panel">0</div>
                        <div class="label">‚è≥ Pendientes</div>
                    </div>
                </div>
                
                <!-- Botones de acci√≥n -->
                <div id="acciones-panel" style="display: none; margin-bottom: 20px;">
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="btn btn-primary" onclick="enviarListadoCorreo()" style="flex: 1; min-width: 200px;">
                            üìß Enviar por Correo
                        </button>
                        <button class="btn" onclick="generarPDFListado()" style="flex: 1; min-width: 200px; background: #666; color: white;">
                            üìÑ Ver Vista Previa
                        </button>
                    </div>
                </div>
                
                <!-- Grid del listado -->
                <div id="listado-panel-grid">
                    <div class="empty-state">
                        <div class="icon">üëÜ</div>
                        <h3>Selecciona un viernes</h3>
                        <p>Para ver los candidatos agendados para entrevista panel</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby-HOsviZvkv83Lrsu6cFukqRK6uuft9nw438lxPv2WOX_prRx3CfosVF7-BxuwBJCQ9A/exec';
        // Sistema de usuarios
const USUARIOS = {
    // Reclutadoras (solo ven sus candidatos)
    'Karla Flores': { password: 'Karla2026!', rol: 'reclutadora', reclutadora: 'Karla Flores' },
    'Yessica Huerta': { password: 'Yessica2026!', rol: 'reclutadora', reclutadora: 'Yessica Huerta' },
    'Jezabel Monterrosas': { password: 'Jezabel2026!', rol: 'reclutadora', reclutadora: 'Jezabel Monterrosas' },
    // Usuarios master (ven todo)
    'Jonathan': { password: 'Jona@master26!', rol: 'master' },
    'Pilar': { password: 'Pilar@master26!', rol: 'master' },
    'Administrador': { password: 'Admin@expert26!', rol: 'master' }
};

let usuarioActual = null;

// Funciones de login
function inicializarLogin() {
    const select = document.getElementById('login-usuario');
    Object.keys(USUARIOS).sort().forEach(nombre => {
        const opt = document.createElement('option');
        opt.value = nombre;
        opt.textContent = nombre;
        select.appendChild(opt);
    });
    
    // Verificar sesi√≥n guardada
    const sesion = localStorage.getItem('entrevista_telefonica_sesion');
    if (sesion) {
        const data = JSON.parse(sesion);
        if (data.nombre && data.expira > Date.now()) {
            usuarioActual = { nombre: data.nombre, ...USUARIOS[data.nombre] };
            mostrarSesionActiva();
            return;
        }
    }
    
    // Enter en password
    document.getElementById('login-password').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') intentarLogin();
    });
}

function intentarLogin() {
    const nombre = document.getElementById('login-usuario').value;
    const password = document.getElementById('login-password').value;
    
    if (!nombre || !password) {
        document.getElementById('login-error').style.display = 'block';
        document.getElementById('login-error').textContent = 'Completa todos los campos.';
        return;
    }
    
    if (USUARIOS[nombre] && USUARIOS[nombre].password === password) {
        usuarioActual = { nombre: nombre, ...USUARIOS[nombre] };
        // Guardar sesi√≥n (8 horas)
        localStorage.setItem('entrevista_telefonica_sesion', JSON.stringify({
            nombre: nombre,
            expira: Date.now() + (8 * 60 * 60 * 1000)
        }));
        mostrarSesionActiva();
    } else {
        document.getElementById('login-error').style.display = 'block';
        document.getElementById('login-error').textContent = 'Contrase√±a incorrecta.';
        document.getElementById('login-password').value = '';
    }
}

function mostrarSesionActiva() {
    document.getElementById('login-overlay').style.display = 'none';
    document.getElementById('user-badge').style.display = 'flex';
    const iniciales = usuarioActual.nombre.substring(0, 2).toUpperCase();
    document.getElementById('badge-avatar').textContent = iniciales;
    document.getElementById('badge-name').textContent = usuarioActual.nombre;
    
    // Configurar filtros seg√∫n rol
    const filtroReclutadora = document.getElementById('filtro-reclutadora');
    const filtroSucursal = document.getElementById('filtro-sucursal');
    
    if (usuarioActual.rol === 'reclutadora') {
        // Reclutadora solo ve sus candidatos
        filtroReclutadora.value = usuarioActual.reclutadora;
        filtroReclutadora.disabled = true;
        
        // Ocultar filtro de sucursal para reclutadoras
        filtroSucursal.style.display = 'none';
        
        // Asignar sucursal seg√∫n reclutadora
        if (usuarioActual.reclutadora === 'Karla Flores') {
            filtroSucursal.value = 'Torre JV Ju√°rez';
        } else {
            // Yessica y Jezabel son de Antequera
            filtroSucursal.value = 'Edificio Inbursa Antequera';
        }
    } else {
        // Master ve todo
        filtroReclutadora.disabled = false;
        filtroSucursal.style.display = 'block';
    }
    
    cargarCitasCalendario();
}

function cerrarSesion() {
    localStorage.removeItem('entrevista_telefonica_sesion');
    location.reload();
}
        let selectedReclutadora = null;
        let selectedCandidato = null;
        let scores = { q1: 0, q2: 0, q3: 0, q4: 0, q5: 0, q6: 0 };
        let candidatos = [];
        let citasCalendario = [];
        let selectedViernes = null;
        let selectedHorario = null;
        let resultadoFinal = null;

        const HORARIOS = [
            { hora: '10:00', fin: '10:45' },
            { hora: '10:45', fin: '11:30' },
            { hora: '11:30', fin: '12:15' },
            { hora: '12:15', fin: '13:00' },
            { hora: '13:00', fin: '13:45' },
            { hora: '13:45', fin: '14:30' },
            { hora: '14:30', fin: '16:00', comida: true },
            { hora: '16:00', fin: '16:45' },
            { hora: '16:45', fin: '17:30' },
            { hora: '17:30', fin: '18:15' },
            { hora: '18:15', fin: '19:00' }
        ];

        const DIRECCIONES = {
            'Torre JV Ju√°rez': 'Av. Ju√°rez 2925, La Paz, 72160, Puebla',
            'Edificio Inbursa Antequera': 'Cto Interior 49, Nueva Antequera, 72180, Puebla',
            'Edificio Inbursa': 'Cto Interior 49, Nueva Antequera, 72180, Puebla'
        };

        function cambiarTab(tab) {
    document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    document.querySelector(`[onclick="cambiarTab('${tab}')"]`).classList.add('active');
    document.getElementById(`tab-${tab}`).classList.add('active');
    
    // Cargar datos seg√∫n la pesta√±a
    if (tab === 'calendario') {
        cargarCitasCalendario();??
    } else if (tab === 'evaluacion') {
        cargarCandidatos();
    } else if (tab === 'historial') {
        cargarHistorial();
    } else if (tab === 'listado-panel') {
        cargarViernesDisponibles();
    }
}

        // ==========================================
        // CALENDARIO DE CITAS
        // ==========================================
        async function cargarCitasCalendario() {
            const sucursal = document.getElementById('filtro-sucursal').value;
            const reclutadora = document.getElementById('filtro-reclutadora').value;
            const periodo = document.getElementById('filtro-periodo').value;
            
            // Si es reclutadora y no tiene valor, asignar su reclutadora
            if (usuarioActual && usuarioActual.rol === 'reclutadora' && !reclutadora) {
                document.getElementById('filtro-reclutadora').value = usuarioActual.reclutadora;
            }
            
            const reclutadoraFinal = document.getElementById('filtro-reclutadora').value;
            
            document.getElementById('calendario-grid').innerHTML = `<div class="loading-spinner"><div class="spinner"></div><p>Cargando citas...</p></div>`;
            
            try {
                let url = `${GOOGLE_SCRIPT_URL}?action=getCitasCalendario&periodo=${periodo}`;
                if (reclutadoraFinal) {
                    url += `&reclutadora=${encodeURIComponent(reclutadoraFinal)}`;
                }
                if (sucursal) {
                    url += `&sucursal=${encodeURIComponent(sucursal)}`;
                }
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.status === 'success') {
                    citasCalendario = data.citas || [];
                    renderizarCalendario(citasCalendario, data.stats);
                } else {
                    throw new Error(data.message || 'Error');
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('calendario-grid').innerHTML = `<div class="empty-state"><div class="icon">‚ö†Ô∏è</div><h3>Error al cargar</h3><p>Intenta de nuevo</p></div>`;
            }
        }
        function renderizarCalendario(citas, stats) {
            document.getElementById('stats-cards').style.display = 'grid';
            document.getElementById('stat-hoy').textContent = stats?.hoy || 0;
            document.getElementById('stat-nuevas').textContent = stats?.nuevas || 0;
            document.getElementById('stat-nocontesto').textContent = stats?.noContesto || 0;
            
            const totalPendientes = (stats?.nuevas || 0) + (stats?.noContesto || 0);
            document.getElementById('badge-citas').textContent = totalPendientes;
            
            if (citas.length === 0) {
                document.getElementById('calendario-grid').innerHTML = `<div class="empty-state"><div class="icon">üì≠</div><h3>No hay citas pendientes</h3><p>¬°Excelente! No tienes entrevistas por realizar</p></div>`;
                return;
            }
            
            const citasPorFecha = {};
            citas.forEach(cita => {
                if (!citasPorFecha[cita.fecha]) citasPorFecha[cita.fecha] = [];
                citasPorFecha[cita.fecha].push(cita);
            });
            
            const hoy = new Date().toISOString().split('T')[0];
            let html = '';
            
            Object.keys(citasPorFecha).sort().forEach(fecha => {
                const citasDelDia = citasPorFecha[fecha].sort((a, b) => a.hora.localeCompare(b.hora));
                const esHoy = fecha === hoy;
                const fechaObj = new Date(fecha + 'T12:00:00');
                const fechaLegible = fechaObj.toLocaleDateString('es-MX', { weekday: 'long', day: 'numeric', month: 'long' });
                
                html += `<div class="dia-section"><div class="dia-header ${esHoy ? 'hoy' : ''}"><h3>${esHoy ? 'üìÖ HOY - ' : ''}${fechaLegible}</h3><span class="count">${citasDelDia.length} cita(s)</span></div><div class="citas-lista">`;
                
                citasDelDia.forEach(cita => {
                    const clasificacionClass = cita.puntaje >= 41 ? 'sobresaliente' : cita.puntaje >= 35 ? 'excelente' : 'muy-bueno';
                    const clasificacionTexto = cita.puntaje >= 41 ? 'SOBRESALIENTE' : cita.puntaje >= 35 ? 'EXCELENTE' : 'MUY BUENO';
                    const esNoContesto = cita.estado === 'No Contest√≥';
                    const cardClass = esNoContesto ? 'no-contesto' : clasificacionClass;
                    
                    html += `<div class="cita-card ${cardClass}">
                        <div class="cita-info">
                            <div class="nombre">
                                ${cita.nombre}
                                ${esNoContesto ? `<span class="estado-tag no-contesto">üìµ No Contest√≥</span>` : `<span class="estado-tag nuevo">üÜï Nuevo</span>`}
                                ${cita.intentos > 0 ? `<span class="intentos">${cita.intentos} intento(s)</span>` : ''}
                            </div>
                            <div class="detalles">
                                <span class="hora">üïê ${cita.hora}</span>
                                <span>üìû ${cita.telefono}</span>
                                <span>‚≠ê ${cita.puntaje}/45 <span class="clasificacion ${clasificacionClass}">${clasificacionTexto}</span></span>
                            </div>
                        </div>
                        <div class="cita-acciones">
                            ${cita.cvUrl ? `<button class="btn-accion btn-cv" onclick="window.open('${cita.cvUrl}', '_blank')" title="Ver CV">üìÑ</button>` : ''}
                            <button class="btn-accion btn-llamar" onclick="llamar('${cita.telefono}')">üìû</button>
                            <button class="btn-accion btn-whatsapp" onclick="abrirWhatsApp('${cita.telefono}', '${cita.nombre}')">üí¨</button>
                            <button class="btn-accion btn-evaluar" onclick="iniciarEvaluacion('${cita.telefono}')">üìù Evaluar</button>
                            <button class="btn-accion btn-no-contesto" onclick="marcarNoContesto('${cita.telefono}')">üìµ No Contest√≥</button>
                        </div>
                    </div>`;
                });
                
                html += '</div></div>';
            });
            
            document.getElementById('calendario-grid').innerHTML = html;
        }

        function llamar(telefono) { window.open(`tel:${telefono}`, '_blank'); }

        function abrirWhatsApp(telefono, nombre) {
            const reclutadora = document.getElementById('filtro-reclutadora').value;
            const primerNombre = nombre.split(' ')[0];
            const mensaje = `Hola ${primerNombre}, te escribe ${reclutadora} de ExpertCell, estoy intentando comunicarme contigo para realizar tu entrevista telef√≥nica, ¬øtienes unos minutos?`;
            let tel = telefono.replace(/\D/g, '');
            if (tel.length === 10) tel = '52' + tel;
            window.open(`https://wa.me/${tel}?text=${encodeURIComponent(mensaje)}`, '_blank');
        }

        function iniciarEvaluacion(telefono) {
            cambiarTab('evaluacion');
            const reclutadora = document.getElementById('filtro-reclutadora').value;
            if (reclutadora) {
                document.querySelectorAll('.reclutadora-option').forEach(opt => {
                    if (opt.querySelector('.name').textContent === reclutadora) opt.click();
                });
                setTimeout(() => {
                    const select = document.getElementById('candidato-select');
                    for (let i = 0; i < select.options.length; i++) {
                        if (select.options[i].text.includes(telefono)) {
                            select.value = select.options[i].value;
                            loadCandidate();
                            break;
                        }
                    }
                }, 1500);
            }
        }

        async function marcarNoContesto(telefono) {
            if (!confirm('¬øMarcar como "No Contest√≥"? Se registrar√° un intento de contacto.')) return;
            
            try {
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        tipo: 'actualizar_estado_pf', 
                        telefono: telefono, 
                        estado: 'No Contest√≥', 
                        registrarIntento: true 
                    })
                });
                
                alert('‚úÖ Marcado como "No Contest√≥". Se registr√≥ el intento de contacto.');
                setTimeout(() => cargarCitasCalendario(), 1000);
            } catch (error) { 
                console.error('Error:', error);
                // Intentar de nuevo con no-cors
                try {
                    await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ 
                            tipo: 'actualizar_estado_pf', 
                            telefono: telefono, 
                            estado: 'No Contest√≥', 
                            registrarIntento: true 
                        })
                    });
                    alert('‚úÖ Marcado como "No Contest√≥". Se registr√≥ el intento de contacto.');
                    setTimeout(() => cargarCitasCalendario(), 1000);
                } catch (e) {
                    alert('Error al actualizar');
                }
            }
        }

        // ==========================================
        // HISTORIAL DE ENTREVISTAS
        // ==========================================
        let historialCompleto = [];
        
        async function cargarHistorial() {
            const reclutadora = document.getElementById('filtro-reclutadora-historial').value;
            
            if (!reclutadora) {
                document.getElementById('historial-grid').innerHTML = `<div class="empty-state"><div class="icon">üëÜ</div><h3>Selecciona una reclutadora</h3><p>Para ver el historial de entrevistas</p></div>`;
                return;
            }
            
            document.getElementById('historial-grid').innerHTML = `<div class="loading-spinner"><div class="spinner"></div><p>Cargando historial...</p></div>`;
            
            try {
                const url = `${GOOGLE_SCRIPT_URL}?action=getHistorialEntrevistas&reclutadora=${encodeURIComponent(reclutadora)}`;
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.status === 'success') {
                    historialCompleto = data.entrevistas || [];
                    filtrarHistorial();
                } else {
                    throw new Error(data.message || 'Error');
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('historial-grid').innerHTML = `<div class="empty-state"><div class="icon">‚ö†Ô∏è</div><h3>Error al cargar</h3><p>Intenta de nuevo</p></div>`;
            }
        }

        function limpiarFiltrosHistorial() {
            document.getElementById('busqueda-historial').value = '';
            document.getElementById('fecha-desde-historial').value = '';
            document.getElementById('fecha-hasta-historial').value = '';
            document.getElementById('filtro-resultado-historial').value = 'todos';
            filtrarHistorial();
        }

        function filtrarHistorial() {
            const filtroResultado = document.getElementById('filtro-resultado-historial').value;
            const busqueda = document.getElementById('busqueda-historial').value.toLowerCase().trim();
            const fechaDesde = document.getElementById('fecha-desde-historial').value;
            const fechaHasta = document.getElementById('fecha-hasta-historial').value;
            
            const entrevistasFiltradas = historialCompleto.filter(ent => {
                // Filtrar por resultado
                if (filtroResultado !== 'todos' && ent.resultado !== filtroResultado) {
                    return false;
                }
                
                // Filtrar por b√∫squeda (nombre o tel√©fono)
                if (busqueda) {
                    const nombreMatch = ent.nombre.toLowerCase().includes(busqueda);
                    const telefonoMatch = ent.telefono.includes(busqueda);
                    if (!nombreMatch && !telefonoMatch) return false;
                }
                
                // Filtrar por rango de fechas
                if (fechaDesde || fechaHasta) {
                    const partesFecha = ent.fecha.split('/');
                    // Convertir DD/MM/YYYY a Date
                    const fechaEnt = new Date(partesFecha[2], partesFecha[1] - 1, partesFecha[0]);
                    
                    if (fechaDesde) {
                        const desde = new Date(fechaDesde);
                        if (fechaEnt < desde) return false;
                    }
                    
                    if (fechaHasta) {
                        const hasta = new Date(fechaHasta);
                        hasta.setHours(23, 59, 59, 999);
                        if (fechaEnt > hasta) return false;
                    }
                }
                
                return true;
            });
            
            renderizarHistorial(entrevistasFiltradas);
        }

        const PREGUNTAS_ENTREVISTA = {
            q1: 'üì¢ "En el formulario comentaste que te motiva ganar por resultados, cu√©ntame una experiencia donde eso haya pasado."',
            q2: 'üì¢ "Expl√≠came en 30 segundos qu√© hac√≠as en tu √∫ltimo trabajo."',
            q3: 'üì¢ "Cu√©ntame una llamada dif√≠cil que recuerdes y c√≥mo la manejaste."',
            q4: 'üì¢ "¬øQu√© es lo que m√°s te gusta y lo que menos te gusta de trabajar en ventas?"',
            q5: 'üì¢ "Aqu√≠ trabajamos con metas diarias, seguimiento y presi√≥n constante. ¬øQu√© parte de eso te costar√≠a m√°s y c√≥mo la manejar√≠as?"',
            q6: 'üì¢ "¬øPor qu√© crees que deber√≠amos avanzar contigo y no con otro candidato?"'
        };

        function renderizarHistorial(entrevistas) {
            if (entrevistas.length === 0) {
                document.getElementById('historial-grid').innerHTML = `<div class="empty-state"><div class="icon">üìã</div><h3>Sin resultados</h3><p>No hay entrevistas que coincidan con los filtros</p></div>`;
                return;
            }
            
            let html = `<p style="color:#64748b; margin-bottom:15px; font-size:14px;">Mostrando ${entrevistas.length} entrevista(s)</p>`;
            entrevistas.forEach((ent, index) => {
                const resultadoClass = ent.resultado === 'PASA' ? 'aprobado' : ent.resultado === 'NO PASA' ? 'rechazado' : 'reservas';
                const resultadoTexto = ent.resultado === 'PASA' ? '‚úÖ Aprobado' : ent.resultado === 'NO PASA' ? '‚ùå Rechazado' : '‚ö†Ô∏è Con Reservas';
                
                html += `
                <div class="historial-card ${resultadoClass}">
                    <div class="historial-header">
                        <span class="nombre">${ent.nombre}</span>
                        <span class="resultado ${resultadoClass}">${resultadoTexto}</span>
                    </div>
                    <div class="historial-detalles">
                        <span>üìû ${ent.telefono}</span>
                        <span>üìÖ ${ent.fecha}</span>
                        <span>üìä ${ent.puntaje}/30 pts</span>
                        <span>üè¢ ${ent.sucursal}</span>
                    </div>
                    <button class="btn-ver-detalle" onclick="toggleDetalle(${index})">üëÅÔ∏è Ver detalle</button>
                    <div class="detalle-entrevista" id="detalle-${index}">
                        <h4>Respuestas de la entrevista:</h4>
                        <div class="detalle-pregunta">
                            <div class="pregunta-titulo">1Ô∏è‚É£ Coherencia</div>
                            <div class="pregunta-texto">${PREGUNTAS_ENTREVISTA.q1}</div>
                            <div class="pregunta-respuesta"><strong>Respuesta:</strong> ${ent.respuestas?.q1 || 'Sin respuesta'}</div>
                            <div class="pregunta-puntaje">Puntaje: ${ent.puntajes?.q1 || 0}/5</div>
                        </div>
                        <div class="detalle-pregunta">
                            <div class="pregunta-titulo">2Ô∏è‚É£ Comunicaci√≥n Real</div>
                            <div class="pregunta-texto">${PREGUNTAS_ENTREVISTA.q2}</div>
                            <div class="pregunta-respuesta"><strong>Respuesta:</strong> ${ent.respuestas?.q2 || 'Sin respuesta'}</div>
                            <div class="pregunta-puntaje">Puntaje: ${ent.puntajes?.q2 || 0}/5</div>
                        </div>
                        <div class="detalle-pregunta">
                            <div class="pregunta-titulo">3Ô∏è‚É£ Manejo del Rechazo</div>
                            <div class="pregunta-texto">${PREGUNTAS_ENTREVISTA.q3}</div>
                            <div class="pregunta-respuesta"><strong>Respuesta:</strong> ${ent.respuestas?.q3 || 'Sin respuesta'}</div>
                            <div class="pregunta-puntaje">Puntaje: ${ent.puntajes?.q3 || 0}/5</div>
                        </div>
                        <div class="detalle-pregunta">
                            <div class="pregunta-titulo">4Ô∏è‚É£ Energ√≠a y Actitud</div>
                            <div class="pregunta-texto">${PREGUNTAS_ENTREVISTA.q4}</div>
                            <div class="pregunta-respuesta"><strong>Respuesta:</strong> ${ent.respuestas?.q4 || 'Sin respuesta'}</div>
                            <div class="pregunta-puntaje">Puntaje: ${ent.puntajes?.q4 || 0}/5</div>
                        </div>
                        <div class="detalle-pregunta">
                            <div class="pregunta-titulo">5Ô∏è‚É£ Realismo del Puesto</div>
                            <div class="pregunta-texto">${PREGUNTAS_ENTREVISTA.q5}</div>
                            <div class="pregunta-respuesta"><strong>Respuesta:</strong> ${ent.respuestas?.q5 || 'Sin respuesta'}</div>
                            <div class="pregunta-puntaje">Puntaje: ${ent.puntajes?.q5 || 0}/5</div>
                        </div>
                        <div class="detalle-pregunta">
                            <div class="pregunta-titulo">6Ô∏è‚É£ Cierre - Autoventa</div>
                            <div class="pregunta-texto">${PREGUNTAS_ENTREVISTA.q6}</div>
                            <div class="pregunta-respuesta"><strong>Respuesta:</strong> ${ent.respuestas?.q6 || 'Sin respuesta'}</div>
                            <div class="pregunta-puntaje">Puntaje: ${ent.puntajes?.q6 || 0}/5</div>
                        </div>
                        ${ent.observaciones ? `<div class="detalle-pregunta"><div class="pregunta-titulo">üìù Observaciones Generales</div><div class="pregunta-respuesta">${ent.observaciones}</div></div>` : ''}
                    </div>
                </div>`;
            });
            
            document.getElementById('historial-grid').innerHTML = html;
        }

        function toggleDetalle(index) {
            const detalle = document.getElementById(`detalle-${index}`);
            detalle.classList.toggle('visible');
        }

        function nuevaEvaluacion() {
            // Resetear selecci√≥n de candidato
            selectedCandidato = null;
            scores = { q1: 0, q2: 0, q3: 0, q4: 0, q5: 0, q6: 0 };
            selectedViernes = null;
            selectedHorario = null;
            resultadoFinal = null;
            
            // Limpiar formulario
            document.getElementById('candidato-select').value = '';
            document.getElementById('candidate-info').style.display = 'none';
            document.getElementById('section-evaluacion').classList.add('hidden');
            document.getElementById('result-panel').style.display = 'none';
            document.getElementById('agenda-section').style.display = 'none';
            document.getElementById('rejected-section').style.display = 'none';
            document.getElementById('confirmacion-panel').style.display = 'none';
            document.getElementById('btn-calcular').style.display = 'block';
            
            // Limpiar campos
            for (let i = 1; i <= 6; i++) {
                document.getElementById(`response-q${i}`).value = '';
                document.querySelectorAll(`#score-options-q${i} .score-option`).forEach(opt => opt.classList.remove('selected'));
            }
            document.getElementById('observaciones-generales').value = '';
            document.getElementById('email-candidato').value = '';
            
            // Recargar candidatos
            if (selectedReclutadora) {
                cargarCandidatos();
            }
            
            // Scroll al inicio
            document.getElementById('section-candidato').scrollIntoView({ behavior: 'smooth' });
        }

        // ==========================================
        // LISTADO PANEL
        // ==========================================
        let listadoPanelData = [];
        
        async function cargarViernesDisponibles() {
            try {
                const url = `${GOOGLE_SCRIPT_URL}?action=getViernesDisponibles`;
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.status === 'success') {
                    const select = document.getElementById('filtro-viernes-panel');
                    select.innerHTML = '<option value="">Selecciona un viernes...</option>';
                    data.viernes.forEach(v => {
                        select.innerHTML += `<option value="${v.fecha}">${v.fechaLegible}</option>`;
                    });
                }
            } catch (error) {
                console.error('Error cargando viernes:', error);
            }
        }
        
        async function cargarListadoPanel() {
            const fecha = document.getElementById('filtro-viernes-panel').value;
            const sucursal = document.getElementById('filtro-sucursal-panel').value;
            
            if (!fecha) {
                document.getElementById('listado-panel-grid').innerHTML = `<div class="empty-state"><div class="icon">üëÜ</div><h3>Selecciona un viernes</h3><p>Para ver los candidatos agendados</p></div>`;
                document.getElementById('stats-panel').style.display = 'none';
                document.getElementById('acciones-panel').style.display = 'none';
                return;
            }
            
            document.getElementById('listado-panel-grid').innerHTML = `<div class="loading-spinner"><div class="spinner"></div><p>Cargando listado...</p></div>`;
            
            try {
                const url = `${GOOGLE_SCRIPT_URL}?action=getListadoPanel&fecha=${encodeURIComponent(fecha)}&sucursal=${encodeURIComponent(sucursal)}`;
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.status === 'success') {
                    listadoPanelData = data.candidatos || [];
                    renderizarListadoPanel();
                } else {
                    throw new Error(data.message || 'Error');
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('listado-panel-grid').innerHTML = `<div class="empty-state"><div class="icon">‚ö†Ô∏è</div><h3>Error al cargar</h3><p>Intenta de nuevo</p></div>`;
            }
        }
        
        function renderizarListadoPanel() {
            const candidatos = listadoPanelData;
            
            // Stats
            const confirmados = candidatos.filter(c => c.estado === 'Confirmado').length;
            const pendientes = candidatos.filter(c => c.estado !== 'Confirmado').length;
            
            document.getElementById('stat-total-panel').textContent = candidatos.length;
            document.getElementById('stat-confirmados-panel').textContent = confirmados;
            document.getElementById('stat-pendientes-panel').textContent = pendientes;
            document.getElementById('stats-panel').style.display = 'grid';
            document.getElementById('acciones-panel').style.display = candidatos.length > 0 ? 'block' : 'none';
            
            if (candidatos.length === 0) {
                document.getElementById('listado-panel-grid').innerHTML = `<div class="empty-state"><div class="icon">üì≠</div><h3>Sin candidatos</h3><p>No hay candidatos agendados para esta fecha</p></div>`;
                return;
            }
            
            let html = '';
            candidatos.forEach((c, index) => {
                const estadoClass = c.estado === 'Confirmado' ? 'confirmado' : 'asignado';
                const estadoTexto = c.estado === 'Confirmado' ? '‚úÖ' : '‚è≥';
                const resultadoClass = c.resultado === 'PASA' ? 'pasa' : 'reservas';
                
                html += `
                <div class="panel-card-compact">
                    <div class="panel-compact-header">
                        <div class="panel-compact-left">
                            <span class="panel-compact-num">${index + 1}</span>
                            <div class="panel-compact-info">
                                <div class="panel-compact-nombre">${c.nombre} <span class="panel-estado ${estadoClass}">${estadoTexto}</span></div>
                                <div class="panel-compact-detalles">
                                    üìû ${c.telefono} | üìß ${c.email} | üéÇ ${c.edad} a√±os | üìç ${c.ubicacion}
                                </div>
                            </div>
                        </div>
                        <div class="panel-compact-right">
                            <span class="panel-compact-hora">üïê ${c.horaInicio}</span>
                            <div class="panel-compact-puntajes">
                                <span class="panel-mini-puntaje">PF: ${c.puntajePF}/45</span>
                                <span class="panel-mini-puntaje">ET: ${c.puntajeET}/30</span>
                                <span class="panel-mini-puntaje ${resultadoClass}">${c.resultado}</span>
                            </div>
                        </div>
                    </div>
                    ${c.respuestasET && Object.keys(c.respuestasET).length > 0 ? `
                    <button class="panel-toggle-respuestas" onclick="toggleRespuestasPanel(${index})">üìù Ver respuestas</button>
                    <div class="panel-respuestas" id="respuestas-panel-${index}" style="display: none;">
                        ${c.respuestasET.q1 ? `<div class="panel-respuesta-item"><div class="q-titulo">1. Coherencia:</div><div class="q-respuesta">${c.respuestasET.q1}</div></div>` : ''}
                        ${c.respuestasET.q2 ? `<div class="panel-respuesta-item"><div class="q-titulo">2. Comunicaci√≥n:</div><div class="q-respuesta">${c.respuestasET.q2}</div></div>` : ''}
                        ${c.respuestasET.q3 ? `<div class="panel-respuesta-item"><div class="q-titulo">3. Manejo Rechazo:</div><div class="q-respuesta">${c.respuestasET.q3}</div></div>` : ''}
                        ${c.respuestasET.q4 ? `<div class="panel-respuesta-item"><div class="q-titulo">4. Energ√≠a/Actitud:</div><div class="q-respuesta">${c.respuestasET.q4}</div></div>` : ''}
                        ${c.respuestasET.q5 ? `<div class="panel-respuesta-item"><div class="q-titulo">5. Realismo:</div><div class="q-respuesta">${c.respuestasET.q5}</div></div>` : ''}
                        ${c.respuestasET.q6 ? `<div class="panel-respuesta-item"><div class="q-titulo">6. Autoventa:</div><div class="q-respuesta">${c.respuestasET.q6}</div></div>` : ''}
                        ${c.observacionesET ? `<div class="panel-respuesta-item"><div class="q-titulo">üìå Observaciones:</div><div class="q-respuesta">${c.observacionesET}</div></div>` : ''}
                    </div>
                    ` : ''}
                </div>`;
            });
            
            document.getElementById('listado-panel-grid').innerHTML = html;
        }
        
        function generarAnalisisPanel(c) {
            const puntos = [];
            
            // An√°lisis de puntajes
            if (c.puntajePF >= 41) {
                puntos.push('‚úÖ Perfil sobresaliente en pre-filtro');
            } else if (c.puntajePF < 35) {
                puntos.push('‚ö†Ô∏è Perfil ajustado, validar motivaci√≥n');
            }
            
            if (c.puntajeET >= 25) {
                puntos.push('Excelente en entrevista telef√≥nica');
            } else if (c.puntajeET < 23) {
                puntos.push('‚ö†Ô∏è Profundizar √°reas de oportunidad');
            }
            
            if (c.estado !== 'Confirmado') {
                puntos.push('‚è≥ PENDIENTE DE CONFIRMACI√ìN');
            }
            
            if (c.resultado === 'RESERVAS') {
                puntos.push('‚ö†Ô∏è Candidato CON RESERVAS');
            }
            
            // An√°lisis de respuestas
            if (c.respuestasET) {
                if (c.respuestasET.q3 && (c.respuestasET.q3.toLowerCase().includes('no he tenido') || c.respuestasET.q3.toLowerCase().includes('no recuerdo'))) {
                    puntos.push('üìå Hacer roleplay de objeciones');
                }
                if (c.respuestasET.q5 && (c.respuestasET.q5.toLowerCase().includes('nada') || c.respuestasET.q5.toLowerCase().includes('todo'))) {
                    puntos.push('üìå Validar expectativas realistas');
                }
            }
            
            if (c.observacionesET) {
                puntos.push('üìù Revisar observaciones');
            }
            
            return puntos.length > 0 ? puntos.join(' | ') : 'Sin observaciones especiales';
        }
        
        function toggleRespuestasPanel(index) {
            const div = document.getElementById(`respuestas-panel-${index}`);
            div.style.display = div.style.display === 'none' ? 'block' : 'none';
        }
        
        async function enviarListadoCorreo() {
            const fecha = document.getElementById('filtro-viernes-panel').value;
            const sucursal = document.getElementById('filtro-sucursal-panel').value;
            
            if (!fecha) {
                alert('Selecciona un viernes');
                return;
            }
            
            if (sucursal === 'TODAS') {
                alert('Selecciona una sucursal espec√≠fica para enviar el correo');
                return;
            }
            
            if (!confirm(`¬øEnviar listado de ${sucursal} por correo?`)) return;
            
            try {
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        tipo: 'enviar_listado_panel',
                        fecha: fecha,
                        sucursal: sucursal
                    })
                });
                
                const data = await response.json();
                if (data.status === 'success') {
                    alert('‚úÖ Correo enviado exitosamente');
                } else {
                    alert('Error: ' + data.message);
                }
            } catch (error) {
                // Intentar con no-cors
                await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        tipo: 'enviar_listado_panel',
                        fecha: fecha,
                        sucursal: sucursal
                    })
                });
                alert('‚úÖ Solicitud enviada. Revisa los correos.');
            }
        }
        
        function generarPDFListado() {
            // Abrir en nueva ventana el listado formateado
            const fecha = document.getElementById('filtro-viernes-panel').value;
            const sucursal = document.getElementById('filtro-sucursal-panel').value;
            
            if (!fecha || listadoPanelData.length === 0) {
                alert('No hay datos para mostrar');
                return;
            }
            
            let html = `<!DOCTYPE html><html><head><title>Listado Panel - ${fecha}</title>
            <style>
                body { font-family: Arial, sans-serif; padding: 20px; }
                h1 { color: #0066CC; }
                .candidato { border: 1px solid #ddd; padding: 15px; margin: 15px 0; border-radius: 8px; page-break-inside: avoid; }
                .candidato h3 { margin: 0 0 10px; color: #333; }
                .info { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 10px 0; }
                .puntajes { display: flex; gap: 20px; margin: 10px 0; }
                .puntaje { background: #f5f5f5; padding: 10px; border-radius: 5px; text-align: center; }
                .analisis { background: #fffbeb; padding: 10px; border-left: 3px solid #f59e0b; margin: 10px 0; }
                @media print { .no-print { display: none; } }
            </style></head><body>
            <h1>üìã Listado Entrevistas Panel</h1>
            <p><strong>Fecha:</strong> ${fecha} | <strong>Sucursal:</strong> ${sucursal}</p>
            <p><strong>Total:</strong> ${listadoPanelData.length} candidatos</p>
            <button class="no-print" onclick="window.print()">üñ®Ô∏è Imprimir</button>
            <hr>`;
            
            listadoPanelData.forEach((c, i) => {
                html += `
                <div class="candidato">
                    <h3>${i+1}. ${c.nombre} - ${c.horaInicio} - ${c.estado === 'Confirmado' ? '‚úÖ' : '‚è≥'}</h3>
                    <div class="info">
                        <div><strong>Tel:</strong> ${c.telefono}</div>
                        <div><strong>Email:</strong> ${c.email}</div>
                        <div><strong>Edad:</strong> ${c.edad}</div>
                        <div><strong>Ubicaci√≥n:</strong> ${c.ubicacion}</div>
                        <div><strong>Traslado:</strong> ${c.tiempoTraslado}</div>
                        <div><strong>Reclutadora:</strong> ${c.reclutadora}</div>
                    </div>
                    <div class="puntajes">
                        <div class="puntaje"><strong>Pre-Filtro:</strong> ${c.puntajePF}/45</div>
                        <div class="puntaje"><strong>Entrevista Tel:</strong> ${c.puntajeET}/30</div>
                        <div class="puntaje"><strong>Resultado:</strong> ${c.resultado}</div>
                    </div>
                    <div class="analisis"><strong>üéØ An√°lisis:</strong> ${generarAnalisisPanel(c)}</div>
                </div>`;
            });
            
            html += '</body></html>';
            
            const ventana = window.open('', '_blank');
            ventana.document.write(html);
            ventana.document.close();
        }
        
        // Cargar viernes al iniciar la pesta√±a
        document.addEventListener('DOMContentLoaded', function() {
            cargarViernesDisponibles();
        });

        // ==========================================
        // EVALUACI√ìN
        // ==========================================
        async function cargarCandidatos() {
            const select = document.getElementById('candidato-select');
            select.innerHTML = '<option value="">‚è≥ Cargando...</option>';
            try {
                const url = `${GOOGLE_SCRIPT_URL}?action=getCandidatosPorReclutador&reclutador=${encodeURIComponent(selectedReclutadora.nombre)}`;
                const response = await fetch(url);
                const data = await response.json();
                if (data.status === 'success' && data.candidatos) {
                    candidatos = data.candidatos;
                    select.innerHTML = '<option value="">-- Selecciona --</option>';
                    if (candidatos.length === 0) { select.innerHTML = '<option value="">No hay candidatos pendientes</option>'; return; }
                    candidatos.forEach((c, i) => {
                        const icon = c.puntaje >= 41 ? 'üåü' : c.puntaje >= 35 ? '‚≠ê' : '‚úÖ';
                        const estadoTag = c.estado === 'No Contest√≥' ? ' üìµ' : '';
                        select.innerHTML += `<option value="${i}">${c.nombre} - ${c.telefono} - ${c.puntaje}pts ${icon}${estadoTag}</option>`;
                    });
                }
            } catch (error) { select.innerHTML = '<option value="">Error al cargar</option>'; }
        }

        function selectReclutadora(nombre, ubicacion) {
            document.querySelectorAll('.reclutadora-option').forEach(opt => opt.classList.remove('selected'));
            event.target.closest('.reclutadora-option').classList.add('selected');
            selectedReclutadora = { nombre, ubicacion };
            document.getElementById('section-candidato').classList.remove('hidden');
            cargarCandidatos();
        }

        function loadCandidate() {
            const index = document.getElementById('candidato-select').value;
            if (index === '') {
                document.getElementById('candidate-info').style.display = 'none';
                document.getElementById('section-evaluacion').classList.add('hidden');
                return;
            }
            selectedCandidato = candidatos[index];
            document.getElementById('info-nombre').textContent = selectedCandidato.nombre;
            document.getElementById('info-telefono').textContent = selectedCandidato.telefono;
            document.getElementById('info-edad').textContent = selectedCandidato.edad + ' a√±os';
            document.getElementById('info-ubicacion').textContent = selectedCandidato.ubicacion;
            document.getElementById('info-sucursal').textContent = selectedCandidato.sucursal;
            document.getElementById('info-traslado').textContent = selectedCandidato.tiempoTraslado || 'N/A';
            document.getElementById('info-ingreso').textContent = selectedCandidato.ingresoEsperado || 'N/A';
            const puntajeClass = selectedCandidato.puntaje >= 41 ? 'score-high' : selectedCandidato.puntaje >= 35 ? 'score-med' : 'score-low';
            document.getElementById('info-puntaje').innerHTML = `<span class="score-badge ${puntajeClass}">${selectedCandidato.puntaje}/45 pts</span>`;
            document.getElementById('candidate-info').style.display = 'block';
            document.getElementById('section-evaluacion').classList.remove('hidden');

            // Mostrar bot√≥n CV si existe
            if (selectedCandidato.cvUrl && selectedCandidato.cvUrl !== '') {
                document.getElementById('cv-container').style.display = 'block';
                document.getElementById('btn-ver-cv').href = selectedCandidato.cvUrl;
            } else {
                document.getElementById('cv-container').style.display = 'none';
            }
            resetEvaluacion();
        }

        function resetEvaluacion() {
            scores = { q1: 0, q2: 0, q3: 0, q4: 0, q5: 0, q6: 0 };
            for (let i = 1; i <= 6; i++) {
                document.getElementById(`response-q${i}`).value = '';
                document.querySelectorAll(`#score-options-q${i} .score-option`).forEach(opt => opt.classList.remove('selected'));
            }
            document.getElementById('observaciones-generales').value = '';
            document.getElementById('result-panel').style.display = 'none';
            document.getElementById('agenda-section').style.display = 'none';
            document.getElementById('rejected-section').style.display = 'none';
            document.getElementById('confirmacion-panel').style.display = 'none';
            document.getElementById('btn-calcular').style.display = 'block';
        }

        function selectScore(q, s) {
            scores[q] = s;
            document.querySelectorAll(`#score-options-${q} .score-option`).forEach(opt => opt.classList.remove('selected'));
            event.target.closest('.score-option').classList.add('selected');
        }

        function calcularResultado() {
            let faltantes = [];
            for (let i = 1; i <= 6; i++) { if (scores[`q${i}`] === 0) faltantes.push(`Pregunta ${i}`); }
            if (faltantes.length > 0) { alert('‚ö†Ô∏è Falta puntaje en: ' + faltantes.join(', ')); return; }
            
            const total = Object.values(scores).reduce((a, b) => a + b, 0);
            document.getElementById('total-score').textContent = `${total}/30`;
            
            let verdict, verdictClass, verdictText;
            if (total >= 25) { verdict = '‚úÖ PASA A PANEL'; verdictClass = 'verdict-pass'; verdictText = 'Excelente. Agendar panel.'; resultadoFinal = 'PASA'; }
            else if (total >= 20) { verdict = '‚ö†Ô∏è CON RESERVAS'; verdictClass = 'verdict-maybe'; verdictText = '√Åreas de mejora. Agendar con observaciones.'; resultadoFinal = 'RESERVAS'; }
            else { verdict = '‚ùå NO PASA'; verdictClass = 'verdict-fail'; verdictText = 'No cumple el perfil.'; resultadoFinal = 'NO PASA'; }
            
            document.getElementById('verdict-badge').textContent = verdict;
            document.getElementById('verdict-badge').className = 'verdict ' + verdictClass;
            document.getElementById('verdict-text').textContent = verdictText;
            document.getElementById('result-panel').style.display = 'block';
            document.getElementById('btn-calcular').style.display = 'none';
            
            if (total >= 20) { 
                document.getElementById('agenda-section').style.display = 'block'; 
                cargarViernes(); 
            } else { 
                document.getElementById('rejected-section').style.display = 'block'; 
                // Guardar autom√°ticamente cuando no aprueba
                guardarRechazo();
            }
            
            document.getElementById('result-panel').scrollIntoView({ behavior: 'smooth' });
        }

        function cargarViernes() {
            const container = document.getElementById('viernes-selector');
            container.innerHTML = '';
            const hoy = new Date();
            const viernes = [];
            for (let i = 0; i < 30 && viernes.length < 4; i++) {
                const fecha = new Date(hoy); fecha.setDate(hoy.getDate() + i);
                if (fecha.getDay() === 5) viernes.push(fecha);
            }
            viernes.forEach(v => {
                const fechaStr = `${v.getFullYear()}-${String(v.getMonth()+1).padStart(2,'0')}-${String(v.getDate()).padStart(2,'0')}`;
                const fechaLegible = v.toLocaleDateString('es-MX', { weekday: 'long', day: 'numeric', month: 'long' });
                const div = document.createElement('div');
                div.className = 'viernes-option';
                div.innerHTML = `<div class="fecha">${fechaLegible}</div>`;
                div.onclick = () => selectViernes(fechaStr, fechaLegible, div);
                container.appendChild(div);
            });
        }

        function selectViernes(fecha, fechaLegible, element) {
            document.querySelectorAll('.viernes-option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            selectedViernes = { fecha, fechaLegible };
            document.getElementById('horarios-container').style.display = 'block';
            cargarHorarios(fecha);
        }

        async function cargarHorarios(fecha) {
            const container = document.getElementById('horarios-grid');
            container.innerHTML = '<p style="text-align:center;">‚è≥ Cargando...</p>';
            let ocupados = [];
            try {
                const url = `${GOOGLE_SCRIPT_URL}?action=getSlots&fecha=${encodeURIComponent(fecha)}&sucursal=${encodeURIComponent(selectedCandidato.sucursal)}`;
                const response = await fetch(url);
                const data = await response.json();
                if (data.ocupados) ocupados = data.ocupados;
            } catch (error) { console.error('Error:', error); }
            
            container.innerHTML = '';
            HORARIOS.forEach(h => {
                const div = document.createElement('div');
                div.className = 'horario-slot';
                if (h.comida) { div.classList.add('comida'); div.innerHTML = 'üçΩÔ∏è COMIDA'; }
                else if (ocupados.includes(h.hora)) { div.classList.add('ocupado'); div.innerHTML = `${h.hora} - ${h.fin}`; }
                else { div.innerHTML = `${h.hora} - ${h.fin}`; div.onclick = () => selectHorario(h.hora, h.fin, div); }
                container.appendChild(div);
            });
            document.getElementById('btn-agendar').style.display = 'block';
        }

        function selectHorario(inicio, fin, element) {
            if (element.classList.contains('ocupado') || element.classList.contains('comida')) return;
            document.querySelectorAll('.horario-slot').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            selectedHorario = { inicio, fin };
        }

        function confirmarAgenda() {
            const email = document.getElementById('email-candidato').value.trim();
            if (!email) { alert('‚ö†Ô∏è Ingresa el correo'); return; }
            if (!selectedViernes) { alert('‚ö†Ô∏è Selecciona un viernes'); return; }
            if (!selectedHorario) { alert('‚ö†Ô∏è Selecciona un horario'); return; }
            guardarEvaluacionYCita(email);
        }

        async function guardarEvaluacionYCita(email) {
            const btn = document.getElementById('btn-agendar');
            btn.disabled = true; btn.innerHTML = '<span class="loading"></span> Guardando...';
            const total = Object.values(scores).reduce((a, b) => a + b, 0);
            const tokenConfirmacion = 'conf_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            
            const data = {
                tipo: 'entrevista_telefonica', timestamp: new Date().toLocaleString('es-MX'),
                reclutadora: selectedReclutadora.nombre, candidato_nombre: selectedCandidato.nombre,
                candidato_telefono: selectedCandidato.telefono, candidato_email: email,
                candidato_sucursal: selectedCandidato.sucursal, puntaje_prefiltro: selectedCandidato.puntaje,
                respuesta_q1: document.getElementById('response-q1').value, respuesta_q2: document.getElementById('response-q2').value,
                respuesta_q3: document.getElementById('response-q3').value, respuesta_q4: document.getElementById('response-q4').value,
                respuesta_q5: document.getElementById('response-q5').value, respuesta_q6: document.getElementById('response-q6').value,
                puntaje_q1: scores.q1, puntaje_q2: scores.q2, puntaje_q3: scores.q3, puntaje_q4: scores.q4, puntaje_q5: scores.q5, puntaje_q6: scores.q6,
                puntaje_total: total, resultado: resultadoFinal, observaciones: document.getElementById('observaciones-generales').value,
                panel_fecha: selectedViernes.fecha, panel_hora: selectedHorario.inicio, panel_hora_fin: selectedHorario.fin, token_confirmacion: tokenConfirmacion
            };
            window.tokenConfirmacion = tokenConfirmacion;
            
            try {
                await fetch(GOOGLE_SCRIPT_URL, { method: 'POST', mode: 'no-cors', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });
                document.getElementById('agenda-section').style.display = 'none';
                document.getElementById('confirmacion-panel').style.display = 'block';
                document.getElementById('conf-nombre').textContent = selectedCandidato.nombre;
                document.getElementById('conf-fecha').textContent = selectedViernes.fechaLegible;
                document.getElementById('conf-hora').textContent = `${selectedHorario.inicio} - ${selectedHorario.fin}`;
                document.getElementById('conf-sucursal').textContent = selectedCandidato.sucursal;
                document.getElementById('conf-email').textContent = email;
                document.getElementById('confirmacion-panel').scrollIntoView({ behavior: 'smooth' });
            } catch (error) { alert('‚ö†Ô∏è Error al guardar'); btn.disabled = false; btn.innerHTML = '‚úÖ Confirmar Cita'; }
        }

        function enviarWhatsAppAprobado() {
            const direccion = DIRECCIONES[selectedCandidato.sucursal] || selectedCandidato.sucursal;
            const link = `${GOOGLE_SCRIPT_URL}?action=confirmar&token=${window.tokenConfirmacion}`;
            const mensaje = `¬°Hola ${selectedCandidato.nombre.split(' ')[0]}! üéâ\n\n*¬°Felicidades!* Pasaste a *Entrevista Panel*.\n\nüìÖ *Fecha:* ${selectedViernes.fechaLegible}\nüïê *Hora:* ${selectedHorario.inicio}\nüìç *Lugar:* ${selectedCandidato.sucursal}\nüìå *Direcci√≥n:* ${direccion}\n\nüìÑ Lleva: INE, CURP, RFC, NSS, Comprobante domicilio, CV\n\n‚úÖ *Confirma aqu√≠:* ${link}\n\n¬°Te esperamos!\n*ExpertCell*`;
            window.open(`https://wa.me/52${selectedCandidato.telefono}?text=${encodeURIComponent(mensaje)}`, '_blank');
        }

        function enviarEmailAprobado() {
            const email = document.getElementById('email-candidato').value;
            const direccion = DIRECCIONES[selectedCandidato.sucursal] || selectedCandidato.sucursal;
            const link = `${GOOGLE_SCRIPT_URL}?action=confirmar&token=${window.tokenConfirmacion}`;
            const subject = `‚úÖ Confirmaci√≥n Entrevista Panel - ExpertCell | ${selectedViernes.fechaLegible}`;
            const body = `Hola ${selectedCandidato.nombre.split(' ')[0]},\n\n¬°Felicidades! Pasaste a Entrevista Panel.\n\nFecha: ${selectedViernes.fechaLegible}\nHora: ${selectedHorario.inicio}\nLugar: ${selectedCandidato.sucursal}\nDirecci√≥n: ${direccion}\n\nDocumentos: INE, CURP, RFC, NSS, Comprobante domicilio, CV\n\nConfirma tu asistencia: ${link}\n\n¬°Te esperamos!\nExpertCell`;
            window.open(`mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`, '_blank');
        }

        function enviarWhatsAppRechazo() {
            if (!selectedCandidato) return;
            const mensaje = `Hola ${selectedCandidato.nombre.split(' ')[0]},\n\nGracias por tu inter√©s en ExpertCell.\n\nEn esta ocasi√≥n continuamos con otros candidatos. Te invitamos a aplicar a futuras vacantes.\n\n¬°√âxito en tu b√∫squeda!\n*ExpertCell*`;
            guardarRechazo();
            window.open(`https://wa.me/52${selectedCandidato.telefono.replace(/\D/g, '')}?text=${encodeURIComponent(mensaje)}`, '_blank');
        }

        async function guardarRechazo() {
            const total = Object.values(scores).reduce((a, b) => a + b, 0);
            const data = {
                tipo: 'entrevista_telefonica', timestamp: new Date().toLocaleString('es-MX'),
                reclutadora: selectedReclutadora.nombre, candidato_nombre: selectedCandidato.nombre,
                candidato_telefono: selectedCandidato.telefono, candidato_email: '', candidato_sucursal: selectedCandidato.sucursal,
                puntaje_prefiltro: selectedCandidato.puntaje,
                respuesta_q1: document.getElementById('response-q1').value, respuesta_q2: document.getElementById('response-q2').value,
                respuesta_q3: document.getElementById('response-q3').value, respuesta_q4: document.getElementById('response-q4').value,
                respuesta_q5: document.getElementById('response-q5').value, respuesta_q6: document.getElementById('response-q6').value,
                puntaje_q1: scores.q1, puntaje_q2: scores.q2, puntaje_q3: scores.q3, puntaje_q4: scores.q4, puntaje_q5: scores.q5, puntaje_q6: scores.q6,
                puntaje_total: total, resultado: 'NO PASA', observaciones: document.getElementById('observaciones-generales').value,
                panel_fecha: '', panel_hora: '', panel_hora_fin: ''
            };
            try { await fetch(GOOGLE_SCRIPT_URL, { method: 'POST', mode: 'no-cors', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) }); } catch (e) {}
        }
        
        // Inicializar al cargar la p√°gina
        document.addEventListener('DOMContentLoaded', inicializarLogin);
    </script>
</body>
</html>
